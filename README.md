# README: Flask Task Management API

## Описание

Flask Task Management API — это RESTful API, предназначенное для управления задачами и пользователями. API предоставляет функционал для регистрации и авторизации пользователей, а также выполнения CRUD-операций с задачами.

## Установка и запуск

### Шаги установки

1. Клонируйте репозиторий:
   ```bash
   git clone <repository_url>
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите приложение:
   ```bash
   python app_users.py
   ```
4. API будет доступно по адресу: `http://localhost:5000`

### Зависимости

Список зависимостей указан в файле `requirements.txt` и включает:

- Flask
- Flask-RESTx
- Flask-SQLAlchemy
- Flask-Bcrypt
- Flask-JWT-Extended

## Структура базы данных

### Пользователи (User)

- `id` (Integer, Primary Key): Идентификатор пользователя
- `username` (String): Имя пользователя
- `password` (String): Хэшированный пароль

### Задачи (Task)

- `id` (Integer, Primary Key): Идентификатор задачи
- `title` (String): Название задачи
- `description` (String): Описание задачи
- `done` (Boolean): Статус выполнения задачи
- `user_id` (Integer, Foreign Key): Ссылка на пользователя

## Эндпоинты

### Регистрация пользователя

**URL:** `/register`\
**Метод:** `POST`\
**Описание:** Регистрирует нового пользователя.\
**Тело запроса:**

```json
{
  "username": "string",
  "password": "string"
}
```

**Ответ:**

- **201:** Успешная регистрация:
  ```json
  {
    "message": "Пользователь успешно зарегистрирован"
  }
  ```
- **400:** Пользователь с таким именем уже существует.

### Авторизация пользователя

**URL:** `/login`\
**Метод:** `POST`\
**Описание:** Авторизует пользователя и возвращает JWT-токен.\
**Тело запроса:**

```json
{
  "username": "string",
  "password": "string"
}
```

**Ответ:**

- **200:** Успешная авторизация:
  ```json
  {
    "access_token": "string"
  }
  ```
- **401:** Неверное имя пользователя или пароль.

### Получение всех задач

**URL:** `/tasks`\
**Метод:** `GET`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Возвращает список задач для авторизованного пользователя.\
**Ответ:**

- **200:** Успешный ответ:
  ```json
  [
    {
      "id": 1,
      "title": "string",
      "description": "string",
      "done": false
    }
  ]
  ```

### Создание задачи

**URL:** `/tasks`\
**Метод:** `POST`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Создает новую задачу для авторизованного пользователя.\
**Тело запроса:**

```json
{
  "title": "string",
  "description": "string",
  "done": false
}
```

**Ответ:**

- **201:** Успешное создание:
  ```json
  {
    "id": 1,
    "title": "string",
    "description": "string",
    "done": false
  }
  ```
- **400:** Не указано название задачи.

### Получение задачи по ID

**URL:** `/tasks/<int:task_id>`\
**Метод:** `GET`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Возвращает задачу по идентификатору для авторизованного пользователя.\
**Ответ:**

- **200:** Успешный ответ:
  ```json
  {
    "id": 1,
    "title": "string",
    "description": "string",
    "done": false
  }
  ```
- **404:** Задача не найдена.

### Обновление задачи

**URL:** `/tasks/<int:task_id>`\
**Метод:** `PUT`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Обновляет данные задачи для авторизованного пользователя.\
**Тело запроса:**

```json
{
  "title": "string",
  "description": "string",
  "done": true
}
```

**Ответ:**

- **200:** Успешное обновление:
  ```json
  {
    "id": 1,
    "title": "string",
    "description": "string",
    "done": true
  }
  ```
- **404:** Задача не найдена.

### Удаление задачи

**URL:** `/tasks/<int:task_id>`\
**Метод:** `DELETE`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Удаляет задачу для авторизованного пользователя.\
**Ответ:**

- **204:** Успешное удаление.
- **404:** Задача не найдена.

### Получение списка пользователей

**URL:** `/users`\
**Метод:** `GET`\
**Авторизация:** Требуется JWT-токен\
**Описание:** Возвращает список всех зарегистрированных пользователей (только для отладки).\
**Ответ:**

- **200:** Успешный ответ:
  ```json
  [
    {
      "id": 1,
      "username": "string"
    }
  ]
  ```

## Тестирование

Для тестирования API используйте файл `test_users.py`. Он включает тесты для всех эндпоинтов.

### Примеры запуска тестов

1. Зарегистрируйте пользователя:
   ```bash
   python test_users.py
   ```
2. Авторизуйтесь и создайте задачи.
3. Выполните CRUD-операции с задачами.

## Логирование

API включает логирование для отслеживания процессов регистрации, авторизации и работы с задачами. Логи записываются в консоль с уровнем DEBUG.

